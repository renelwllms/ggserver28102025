import{r as g,bk as ue,k as x,q,w as he,j as a,ae as pe,ak as fe,H as Q,R as W,aC as me,aD as ge,u as ie,v as se,al as te,bl as ye,Z as be,au as ve,$ as xe,af as we,an as Ce,F as Oe,K as Se,ab as re,M as U,Q as Y,C as ae,L as I,J as K,V as A,O as Ne,U as ne,ai as _e,ad as Ie}from"./index.457aa18e.js";import{S as Pe}from"./index.ddd2fa3d.js";import{P as ke,R as Ee}from"./index.f41f3485.js";import{h as Te}from"./moment.0f22a298.js";import{E as je}from"./exceljs.min.79554570.js";import{F as Re}from"./FileSaver.min.1e452293.js";var H=globalThis&&globalThis.__assign||function(){return H=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},H.apply(this,arguments)},Fe=globalThis&&globalThis.__rest||function(e,r){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(n[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,t=Object.getOwnPropertySymbols(e);l<t.length;l++)r.indexOf(t[l])<0&&Object.prototype.propertyIsEnumerable.call(e,t[l])&&(n[t[l]]=e[t[l]]);return n},$e=globalThis&&globalThis.__read||function(e,r){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var t=n.call(e),l,f=[],d;try{for(;(r===void 0||r-- >0)&&!(l=t.next()).done;)f.push(l.value)}catch(s){d={error:s}}finally{try{l&&!l.done&&(n=t.return)&&n.call(t)}finally{if(d)throw d.error}}return f};function Z(e){var r,n,t=e.children,l=e.style,f=e.className,d=e.prefixCls,s=e.droplist,N=e.dropdownProps,E=e.href,T=e.onClick,y=e.tagName,C=y===void 0?"div":y,P=Fe(e,["children","style","className","prefixCls","droplist","dropdownProps","href","onClick","tagName"]),O=$e(g.exports.useState(!1),2),S=O[0],$=O[1],j=ue(E)?"a":C,D=x(j,{...H({href:E,onClick:T,role:"listitem",style:l,className:q(d+"-item",(r={},r[d+"-item-with-dropdown"]=s,r),f)},he(P)),children:[t,s&&a("span",{"aria-hidden":!0,className:q(d+"-item-dropdown-icon",(n={},n[d+"-item-dropdown-icon-active"]=S,n)),children:a(pe,{})})]});return s?a(fe,{...H({droplist:s,onVisibleChange:function(_){$(_),N&&N.onVisibleChange&&N.onVisibleChange(_)}},Q(N,["onVisibleChange"])),children:D}):D}Z.displayName="BreadcrumbItem";function le(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,t)}return n}function oe(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?le(Object(n),!0).forEach(function(t){ge(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function De(e,r){var n=g.exports.useContext(me),t=n.prefixCls,l=t===void 0?"arco":t,f=e.spin,d=e.className,s=oe(oe({"aria-hidden":!0,focusable:!1,ref:r},e),{},{className:"".concat(d?d+" ":"").concat(l,"-icon ").concat(l,"-icon-oblique-line")});return f&&(s.className="".concat(s.className," ").concat(l,"-icon-loading")),delete s.spin,delete s.isIcon,a("svg",{fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",...s,children:a("path",{d:"M29.506 6.502 18.493 41.498"})})}var X=W.forwardRef(De);X.defaultProps={isIcon:!0};X.displayName="IconObliqueLine";var Be=X,J=globalThis&&globalThis.__assign||function(){return J=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},J.apply(this,arguments)},Le=globalThis&&globalThis.__rest||function(e,r){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(n[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,t=Object.getOwnPropertySymbols(e);l<t.length;l++)r.indexOf(t[l])<0&&Object.prototype.propertyIsEnumerable.call(e,t[l])&&(n[t[l]]=e[t[l]]);return n},ze=function(e,r,n){return r.indexOf(e)===r.length-1?a("span",{children:e.breadcrumbName}):a("a",{href:"#/"+n.join("/").replace(/^\//,""),children:e.breadcrumbName})},Ve={separator:a(Be,{})};function Ae(e,r){var n,t=g.exports.useContext(ie),l=t.getPrefixCls,f=t.componentConfig,d=t.rtl,s=se(e,Ve,f==null?void 0:f.Breadcrumb),N=s.className,E=s.children,T=s.style,y=s.routes,C=s.maxCount,P=s.separator,O=Le(s,["className","children","style","routes","maxCount","separator"]),S=l("breadcrumb"),$="itemRender"in s?s.itemRender:ze,j=a("span",{"aria-label":"ellipses of breadcrumb items",className:S+"-item-ellipses",children:"..."}),D=a("span",{"aria-hidden":!0,className:S+"-item-separator",children:P}),_=function(b,R,m){var F=W.cloneElement(D,{key:m+"_separator"});return R>0?m===0?[b,F,j]:m>R?[F,b]:null:m===0?[b]:[F,b]},B=function(){var b=[],R=y.length-C;return y.map(function(m,F){b.push((m.path||"").replace(/^\//,""));var G=m.children?a(te,{children:m.children.map(function(i){return a(te.Item,{children:$(i,y,b)},i.path||i.breadcrumbName)})}):null;return _(a(Z,{prefixCls:S,droplist:G,children:$(m,y,b)},m.path||m.breadcrumbName),R,F)})},h=function(){var b=[];W.Children.forEach(E,function(m){ye(m)||b.push(m)});var R=b.length-C;return W.Children.map(b,function(m,F){return _(W.cloneElement(m,{prefixCls:S}),R,F)})};return a("div",{...J({role:"list",ref:r,style:T,className:q(S,(n={},n[S+"-rtl"]=d,n),N)},Q(O,["itemRender"])),children:y&&y.length?B():h()})}var We=g.exports.forwardRef(Ae),ee=We;ee.displayName="Breadcrumb";ee.Item=Z;var Me=ee,M=globalThis&&globalThis.__assign||function(){return M=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},M.apply(this,arguments)},qe=globalThis&&globalThis.__rest||function(e,r){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(n[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,t=Object.getOwnPropertySymbols(e);l<t.length;l++)r.indexOf(t[l])<0&&Object.prototype.propertyIsEnumerable.call(e,t[l])&&(n[t[l]]=e[t[l]]);return n},Ke=globalThis&&globalThis.__read||function(e,r){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var t=n.call(e),l,f=[],d;try{for(;(r===void 0||r-- >0)&&!(l=t.next()).done;)f.push(l.value)}catch(s){d={error:s}}finally{try{l&&!l.done&&(n=t.return)&&n.call(t)}finally{if(d)throw d.error}}return f};function ce(e){var r,n,t=g.exports.useContext(ie),l=t.getPrefixCls,f=t.componentConfig,d=t.rtl,s=se(e,{},f==null?void 0:f.PageHeader),N=s.title,E=s.subTitle,T=s.extra,y=s.children,C=s.backIcon,P=s.footer,O=s.breadcrumb,S=qe(s,["title","subTitle","extra","children","backIcon","footer","breadcrumb"]),$=be(),j=Ke(g.exports.useState(!1),2),D=j[0],_=j[1],B=g.exports.useRef(),h=l("page-header");return a(ve,{onResize:function(){B.current&&_(B.current.offsetWidth<768)},getTargetDOMNode:function(){return B.current},children:x("div",{...M({},Q(S,["onBack"]),{ref:B,className:q(""+h,(r={},r[h+"-with-breadcrumb"]=O,r[h+"-with-content"]=y,r[h+"-with-footer"]=P,r[h+"-wrap"]=D,r[h+"-rtl"]=d,r),s.className),style:s.style}),children:[x("div",{className:h+"-head-wrapper",children:[O&&a(Me,{...M({},O)}),x("div",{className:h+"-head",children:[x("div",{className:q(h+"-head-main",(n={},n[h+"-head-main-with-back"]=C,n)),children:[C&&a(xe,{...M({prefix:h,tabIndex:0,role:"button",className:h+"-back",onClick:s.onBack},$({onPressEnter:s.onBack})),children:a("span",{className:h+"-back-icon",children:C===!0?d?a(we,{}):a(Ce,{}):C})}),N&&a("div",{className:h+"-title",children:N}),E&&x(Oe,{children:[a("div",{className:h+"-divider"}),a("div",{className:h+"-sub-title",children:E})]})]}),T&&a("div",{className:h+"-head-extra",children:T})]})]}),y&&a("div",{className:h+"-content",children:y}),P&&a("div",{className:h+"-footer",children:P})]})})}ce.displayName="PageHeader";const w=K.Option,{useForm:He}=I;function Xe(){const[e]=He(),[r,n]=g.exports.useState([]),[t,l]=g.exports.useState(1),[f,d]=g.exports.useState(!1),[s,N]=g.exports.useState([]);g.exports.useState([]);const[E,T]=g.exports.useState([]),[y,C]=g.exports.useState(0),P=Se(i=>i.token);g.exports.useState({});const[O,S]=g.exports.useState({total:0,pageSize:10,current:1});g.exports.useEffect(()=>{P&&_()},[P]);const $=i=>{n(i)},j=[{title:"Learner Name",key:"StudentName",dataIndex:"StudentName",width:160,render:(i,o)=>`${o.FirstName||""} ${o.LastName||""}`},{title:"DOB",dataIndex:"DateOfBirth",key:"DateOfBirth",width:120,ellipsis:!0,render:i=>i?Te(i).format("DD/MM/YYYY"):"-"},{title:"Gender",dataIndex:"Gender",key:"Gender",width:85},{title:"Ethnicity",dataIndex:"Ethnicity",key:"Ethnicity",ellipsis:!0,width:100},{title:"Email",dataIndex:"Email",key:"Email",ellipsis:!0,width:120},{title:"School",dataIndex:"School",key:"School",ellipsis:!0,width:160},{title:"Teacher",dataIndex:"Tutor",key:"Tutor",ellipsis:!0,width:160},{title:"Fees",dataIndex:"Fees",key:"Fees",width:90,ellipsis:!0,render:i=>a("span",{style:{fontSize:"12px"},children:i})},{title:"Region",dataIndex:"Region",key:"Region",ellipsis:!0,width:160},{title:"Status",dataIndex:"Status",key:"Status",ellipsis:!0,width:160}],D=i=>{const{current:o,pageSize:u}=i;S({...i,current:o,pageSize:u}),_({current:o,pageSize:u})},_=(i={})=>{d(!0),re.getReport({...O,...i,total:void 0}).then(o=>{var u,c,p,k;console.log((u=o==null?void 0:o.data)==null?void 0:u[0]),T(((c=o==null?void 0:o.data)==null?void 0:c[0])||[]),N(((p=o==null?void 0:o.data)==null?void 0:p[1])||[]),S({...O,...o==null?void 0:o.pagination}),h((k=o==null?void 0:o.data)==null?void 0:k[0])}).catch(o=>{console.error("Error loading learner results:",o),U.error("Failed to load report data. Please try again."),T([]),N([])}).finally(()=>{d(!1)})},B=(i={})=>{d(!0),re.getReport({...O,...i,total:void 0}).then(o=>{var u,c;console.log((u=o==null?void 0:o.data)==null?void 0:u[0]),F(j,((c=o==null?void 0:o.data)==null?void 0:c[1])||[],"LearnerResults"),U.success("Excel file exported successfully!")}).catch(o=>{console.error("Error exporting report:",o),U.error("Failed to export report. Please try again.")}).finally(()=>{d(!1)})};function h(i){var z;if(!i||i.length===0){C(0);return}try{var o=i.reduce((v,V)=>v+(V.TotalCourse||0),0),u=i.filter(v=>v.CourseStatus!=="On Going").reduce((v,V)=>v+(V.TotalCourse||0),0),c=((z=i.find(v=>v.CourseStatus==="Not Yet Achieved"))==null?void 0:z.TotalCourse)||0,p=i.filter(v=>["Achieved","Excellence","Merit"].includes(v.CourseStatus)).reduce((v,V)=>v+(V.TotalCourse||0),0),k=c>0?(p/(p+c)*100).toFixed(1):0;C(k)}catch(v){console.error("Error calculating statistics:",v),C(0)}}function b(i){return Object.fromEntries(Object.entries(i).filter(([o,u])=>u!=null&&u!==""))}function R(i){const o=Object.entries(i).filter(([u,c])=>c!==void 0).map(([u,c])=>{const p=u.replace(/_/g,".");if(Array.isArray(c)){if(c.length===2)return`${p} >= '${c[0]}' AND ${p} <= '${c[1]}'`;if(c.length===1)return`${p} = '${c[0]}'`;{const k=c.map(z=>`'${z}'`).join(", ");return`${p} IN (${k})`}}else return typeof c=="string"?`${p} = '${c}'`:typeof c=="number"?`${p} = ${c}`:c===null?`${p} IS NULL`:typeof c=="boolean"?`${p} = ${c?1:0}`:`${p} = '${c}'`});return o.length>0?o.join(" AND "):""}const m=()=>{const i=e.getFieldsValue();console.log(i);var o=b(i);console.log(o);var u=R(o);console.log(u),_({current:1,dyquery:u})},F=async(i,o,u)=>{const c=new je.Workbook,p=c.addWorksheet("Sheet1");p.mergeCells("A1:C1");const k=p.getCell("A1");k.value=u,k.font={size:20,bold:!0},k.alignment={horizontal:"center",vertical:"middle"};const z=p.addRow(i.map(L=>L.title));z.eachCell(L=>{L.fill={type:"pattern",pattern:"solid",fgColor:{argb:"ED45A0"}},L.font={color:{argb:"FFFFFFFF"},bold:!0}}),z.height=25,o.forEach(L=>{p.addRow(i.map(de=>L[de.dataIndex]))}),p.columns.forEach(L=>{L.width=30});const v=await c.xlsx.writeBuffer(),V=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Re.exports.saveAs(V,`${u}.xlsx`)},G=()=>{const i=e.getFieldsValue();console.log(i);var o=b(i);console.log(o);var u=R(o);console.log(u),B({current:1,isReport:1,dyquery:u})};return x("div",{style:{padding:20},children:[a(ce,{title:"Learner Results"}),a(Y,{style:{marginBottom:0,width:"100%"},children:a(ae,{style:{marginBottom:20},children:x(I,{form:e,layout:"inline",children:[a(I.Item,{label:"Filter",children:x(K,{placeholder:"Select",style:{width:200},mode:"multiple",value:r,onChange:$,allowClear:!0,children:[a(w,{value:"date",children:"Date"}),a(w,{value:"enrollmentType",children:"Enrollment Type"}),a(w,{value:"ethnicity",children:"Ethnicity"}),a(w,{value:"firstName",children:"First Name"}),a(w,{value:"fees",children:"Fees"}),a(w,{value:"lastName",children:"Last Name"}),a(w,{value:"region",children:"Region"}),a(w,{value:"school",children:"School"}),a(w,{value:"tutor",children:"Tutor"})]})}),r.includes("firstName")&&a(I.Item,{label:"First Name",field:"S_FirstName",children:a(A,{allowClear:!0,style:{width:"100%"},placeholder:"please enter"})}),r.includes("lastName")&&a(I.Item,{label:"Last Name",field:"S_LastName",children:a(A,{allowClear:!0,style:{width:"100%"},placeholder:"please enter"})}),r.includes("enrollmentType")&&a(I.Item,{label:"Enrollment Type",field:"SIC_LearnerType",children:x(K,{defaultValue:"all",style:{width:160},children:[a(w,{value:"1",children:"Remote"}),a(w,{value:"2",children:"Workshop"})]})}),r.includes("fees")&&a(I.Item,{label:"Fees",field:"S_Fees",children:x(K,{style:{width:160},children:[a(w,{value:"Paid",children:"Paid"}),a(w,{value:"Parially Paid",children:"Parially Paid"}),a(w,{value:"Un Paid",children:"Un Paid"})]})}),r.includes("date")&&a(I.Item,{label:"Date",field:"S_CreateDate",children:a(Ne.RangePicker,{})}),r.includes("ethnicity")&&a(I.Item,{label:"Ethnicity",field:"S_Ethnicity",children:a(A,{allowClear:!0,style:{width:"100%"},placeholder:"please enter"})}),r.includes("region")&&a(I.Item,{label:"Region",field:"S_Region",children:a(A,{allowClear:!0,style:{width:"100%"},placeholder:"please enter"})}),r.includes("tutor")&&a(I.Item,{label:"Tutor",field:"S_Tutor",children:a(A,{allowClear:!0,style:{width:"100%"},placeholder:"please enter"})}),x(Y,{children:[a(ne,{type:"primary",icon:a(_e,{}),onClick:m,children:"Search"}),a(ne,{onClick:()=>G(),type:"primary",style:{marginLeft:20},children:"Export Excel"})]})]})})}),a(ae,{style:{marginBottom:20},children:x(Y,{align:"center",style:{width:"100%",justifyContent:"space-between"},children:[x("div",{style:{display:"flex",alignItems:"center",gap:20},children:[a(ke,{type:"circle",percent:y,width:80}),x(Ie.Text,{children:["Passed ",y,"%"]})]}),E.map((i,o)=>a(Pe,{title:i.CourseStatus,value:i.TotalCourse},i.CourseStatus))]})}),a(Ee,{columns:j,rowKey:"ID",data:s,loading:f,scroll:{x:1e3},border:{wrapper:!0,cell:!0},pagination:{...O,size:"mini",bufferSize:3,sizeCanChange:!0,showTotal:!0,showJumper:!0,pageSizeChangeResetCurrent:!0},onChange:D},t)]})}export{Xe as default};
