import{K as I,r as i,k as r,C,j as e,ad as s,Q as E,U as y,b3 as M,J as S,aH as G,b6 as z,O as H,M as p,l as U}from"./index.457aa18e.js";import{T as A}from"./index.f5cc6157.js";import $ from"./report1.5d7b80c7.js";import j from"./report2.e806dd30.js";import W from"./report3.3277d440.js";import J from"./report4.ed126a83.js";import Z from"./report5.6d2a89bb.js";import Q from"./report6.e110a8b0.js";import{h as R}from"./moment.0f22a298.js";import{s as V,e as _}from"./excelExport.aede847f.js";import"./exceljs.min.79554570.js";import"./FileSaver.min.1e452293.js";const{RangePicker:q}=H,{Option:d}=S,k=[{key:"StudentID",label:"Student ID",dataType:"number"},{key:"FirstName",label:"First Name",dataType:"string"},{key:"LastName",label:"Last Name",dataType:"string"},{key:"Email",label:"Email",dataType:"string"},{key:"PhoneNumber",label:"Phone Number",dataType:"string"},{key:"DateOfBirth",label:"Date of Birth",dataType:"date"},{key:"Gender",label:"Gender",dataType:"string"},{key:"Ethnicity",label:"Ethnicity",dataType:"string"},{key:"School",label:"School",dataType:"string"},{key:"SchoolNumber",label:"School Number",dataType:"string"},{key:"Tutor",label:"Tutor",dataType:"string"},{key:"Status",label:"Status",dataType:"string"},{key:"AssignedTo",label:"Assigned To",dataType:"string"},{key:"Fees",label:"Fees",dataType:"string"},{key:"Region",label:"Region",dataType:"string"},{key:"City",label:"City",dataType:"string"},{key:"StreetAddress",label:"Street Address",dataType:"string"},{key:"Zipcode",label:"Zipcode",dataType:"string"},{key:"CreateDate",label:"Registration Date",dataType:"date"},{key:"WorkbookOption",label:"Workbook Option",dataType:"string"},{key:"TeacherName",label:"Teacher Name",dataType:"string"},{key:"TeacherEmail",label:"Teacher Email",dataType:"string"},{key:"InvoiceEmail",label:"Invoice Email",dataType:"string"}];function K(){I(t=>t.token);const[N,b]=i.exports.useState(!1),[h,f]=i.exports.useState([]),[x,O]=i.exports.useState([]),[l,m]=i.exports.useState(["FirstName","LastName","Email","School","Status","CreateDate"]),[a,v]=i.exports.useState([String(R().year()),String(R().year())]),[u,w]=i.exports.useState(void 0),[T,L]=i.exports.useState(void 0);i.exports.useEffect(()=>{const t=l.map(o=>{const n=k.find(g=>g.key===o);return n?{title:n.label,dataIndex:n.key,key:n.key,width:150,ellipsis:!0,render:g=>g?n.dataType==="date"?R(g).format("DD/MM/YYYY"):g:"-"}:null}).filter(Boolean);O(t)},[l]);const D=()=>{if(l.length===0){p.warning("Please select at least one field to display");return}console.log("Starting Report 7 API call with params:",{fields:l.join(","),startYear:(a==null?void 0:a.length)>0?a[0]:void 0,endYear:(a==null?void 0:a.length)>0?a[1]:void 0,status:u,assignedTo:T}),b(!0),U.getReport7({fields:l.join(","),startYear:(a==null?void 0:a.length)>0?a[0]:void 0,endYear:(a==null?void 0:a.length)>0?a[1]:void 0,status:u,assignedTo:T}).then(t=>{console.log("Report 7 API response:",t);const o=(t==null?void 0:t.data)||[];f(o),p.success(`Loaded ${o.length} records`),console.log("Data set to:",o)}).catch(t=>{console.error("Error loading report 7:",t),console.error("Error details:",t.response||t.message),p.error(`Failed to load custom report: ${t.message||"Unknown error"}`),f([])}).finally(()=>{b(!1)})},Y=async()=>{if(h.length===0){p.warning("No data to export. Please run the report first.");return}try{await _(x,h,"CUSTOM REPORT"),p.success("Excel file exported successfully!")}catch(t){console.error("Error exporting report:",t),p.error("Failed to export Excel file. Please try again.")}},B=t=>{m(o=>o.includes(t)?o.filter(n=>n!==t):[...o,t])},F=()=>{m(k.map(t=>t.key))},P=()=>{m([])};return r(C,{className:V["reports-result"],children:[r("div",{style:{marginBottom:20,padding:"16px",background:"#f7f8fa",borderRadius:"4px"},children:[e(s.Title,{heading:6,style:{marginBottom:12},children:"Select Fields to Include in Report"}),r(E,{style:{marginBottom:12},children:[e(y,{size:"small",onClick:F,children:"Select All"}),e(y,{size:"small",onClick:P,children:"Clear All"}),r(s.Text,{type:"secondary",style:{marginLeft:8},children:["(",l.length," fields selected)"]})]}),e("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px",marginBottom:16},children:k.map(t=>e(M,{checked:l.includes(t.key),onChange:()=>B(t.key),children:t.label},t.key))}),e(s.Title,{heading:6,style:{marginTop:20,marginBottom:12},children:"Filter Options"}),r(E,{wrap:!0,children:[r("div",{children:[e(s.Text,{style:{marginRight:8},children:"Date Range:"}),e(q,{value:a,mode:"year",style:{width:200},onChange:t=>{v(t)},size:"small"})]}),r("div",{children:[e(s.Text,{style:{marginRight:8},children:"Status:"}),r(S,{placeholder:"All Statuses",style:{width:160},size:"small",allowClear:!0,value:u,onChange:t=>w(t),children:[e(d,{value:"On Going",children:"On Going"}),e(d,{value:"Completed",children:"Completed"}),e(d,{value:"Withdrawn",children:"Withdrawn"}),e(d,{value:"Did Not Complete",children:"Did Not Complete"}),e(d,{value:"Other",children:"Other"})]})]}),r("div",{children:[e(s.Text,{style:{marginRight:8},children:"Assigned To:"}),r(S,{placeholder:"All",style:{width:160},size:"small",allowClear:!0,value:T,onChange:t=>L(t),children:[e(d,{value:"School",children:"School"}),e(d,{value:"GET Group",children:"GET Group"})]})]})]})]}),e(G,{style:{marginBottom:16},children:r(E,{children:[e(y,{onClick:()=>D(),type:"primary",size:"mini",disabled:l.length===0,children:"Generate Report"}),e(y,{size:"mini",onClick:Y,type:"primary",disabled:h.length===0,children:"Export Excel"}),r(s.Text,{type:"secondary",children:[h.length," record(s) found"]})]})}),e(z,{columns:x,data:h,loading:N,border:{wrapper:!0,cell:!0},scroll:{x:l.length*150,y:600},pagination:{pageSize:50,showTotal:!0,showJumper:!0,sizeCanChange:!0}})]})}const c=A.TabPane;function pe(){return e(C,{style:{height:"100%",minHeight:"80vh",overflow:"auto"},children:r(A,{defaultActiveTab:"1",destroyOnHide:!0,overflow:"wrap",children:[e(c,{title:"LEARNER ENROLMENTS + MONTH + YEAR",children:e($,{})},"1"),e(c,{title:"WORKSHOPS BY REGION + YEAR",children:e(j,{})},"2"),e(c,{title:"SCHOOL + LEARNER NUMBERS + YEAR",children:e(W,{})},"3"),e(c,{title:"SCHOOL + LEARNERS  + YEAR",children:e(J,{})},"4"),e(c,{title:"TUTOR + LEARNER NUMBERS + YEAR",children:e(Z,{})},"5"),e(c,{title:"ETHNICITY + LEARNER NUMBERS + YEAR",children:e(Q,{})},"6"),e(c,{title:"CUSTOM REPORT",children:e(K,{})},"7")]})})}export{pe as default};
