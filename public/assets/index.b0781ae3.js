import{a as e,F as a,j as h,m as v,l as w,B as u,s as xe,t as Ne,G as ie,v as B,E as ke,r as s,h as k,S as E,D as Ee,g as oe,q as ve,a0 as Le,M as g,x as ee,y as Re,z as Ae}from"./index.dbab94e8.js";import{I as we,M as D,D as te}from"./index.b2408667.js";import{R as Fe,P as le}from"./index.1602af59.js";import{C as Oe}from"./index.40af5fda.js";import{h as ze}from"./moment.0f22a298.js";import{L as re,s as ae}from"./index.0f78e0ca.js";import{T as ue}from"./index.027a4f8b.js";const Pe="_toolbar_1e6zf_1",De="_operations_1e6zf_6";var G={toolbar:Pe,operations:De,"content-type":"_content-type_1e6zf_9","search-form-wrapper":"_search-form-wrapper_1e6zf_16","right-button":"_right-button_1e6zf_21","button-group":"_button-group_1e6zf_30","search-form":"_search-form_1e6zf_16"};const{Row:qe,Col:Qe}=ie,{useForm:_e}=a;function Te(m){const[C]=_e(),c=()=>{const b=C.getFieldsValue();m.onSearch(b)},i=()=>{C.resetFields(),m.onSearch({School:void 0,name:void 0})},S=()=>{window.open("https://forms.office.com/r/Uy4i31KrM1")};return e("div",{children:e(a,{form:C,className:G["search-form"],labelAlign:"left",layout:"inline",style:{display:"inline-block",marginBottom:"10px"},children:h(qe,{children:[e(a.Item,{label:"Learner Name",field:"name",children:e(v,{allowClear:!0,placeholder:"Please enter the Learner Name"})}),e(a.Item,{label:"School Name",field:"School",children:e(v,{allowClear:!0,placeholder:"Please enter the School Name"})}),h(w,{children:[e(u,{type:"primary",icon:e(xe,{}),onClick:c,children:"Search"}),e(u,{icon:e(we,{}),onClick:i,children:"Reset"})]}),e("div",{style:{position:"absolute",right:"20px",display:"inline-block"},children:e(u,{type:"primary",icon:e(Ne,{}),onClick:S,children:"register"})})]})})})}const $e=ue.TabPane,se={WorklifeCourses:"WORK & LIFE SKILLS COURSES",HospitalityCourses:"HOSPITALITY COURSES",FarmingUnits:"FARMING AND PRIMARY INDUSTRIES"};function Me({rowData:m}){return e("div",{style:{height:400,width:"100%",overflow:"auto"},children:(()=>{const c=Object.keys(se).map(i=>{if(!m[i])return null;let S=[];try{S=JSON.parse(m[i])||[]}catch{}return e($e,{title:se[i],children:e(re,{size:"small",header:"",dataSource:S,render:(b,x)=>e(re.Item,{children:b},x)})},i)});return c!=null&&c.every(i=>i===null)?e(B,{children:e(ke,{})}):e(ue,{type:"rounded",children:c})})()})}function Ue({handleSubmit:m,loading:C,form:c}){const i=()=>{c.resetFields()};s.exports.useEffect(()=>{x()},[]);const[S,b]=s.exports.useState([]),x=()=>{k.getSchool({}).then(o=>{b((o==null?void 0:o.data)||[])})};return h(a,{form:c,className:G["search-form"],labelAlign:"left",wrapperCol:{span:24},onSubmit:m,children:[e(a.Item,{label:"Learner First Name",field:"FirstName",rules:[{required:!0,message:"required"}],children:e(v,{allowClear:!0,style:{width:"100%"},placeholder:"please enter"})}),e(a.Item,{label:"Learner Last Name",field:"LastName",rules:[{required:!0,message:"required"}],children:e(v,{allowClear:!0,style:{width:"100%"},placeholder:"please enter"})}),e(a.Item,{label:"School Name",field:"School",rules:[{required:!0,message:"required"}],children:e(E,{showSearch:!0,allowClear:!0,options:S.map(o=>({label:o.SchoolName,value:o.SchoolName})),allowCreate:{formatter:o=>({value:o,label:o})},filterOption:(o,y)=>{var I,A,N;return((A=(I=y.props.value)==null?void 0:I.label)==null?void 0:A.toLowerCase().indexOf(o.toLowerCase()))>=0||((N=y.props)==null?void 0:N.children.toLowerCase().indexOf(o.toLowerCase()))>=0},placeholder:"please select (If the option does not exist, you can enter it manually)"})}),e(a.Item,{label:"Date of Birth",field:"DateOfBirth",rules:[{required:!0,message:"required"}],children:e(Ee,{style:{width:"100%"}})}),e(a.Item,{label:"Gender",field:"Gender",rules:[{required:!0,message:"required"}],children:e(E,{allowClear:!0,options:["Male","Female","Other"],placeholder:"please enter"})}),e(a.Item,{label:"Ethnicity",field:"Ethnicity",rules:[{required:!0,message:"required"}],children:e(E,{allowClear:!0,allowCreate:!0,showSearch:!0,options:["Australian","British","Cambodian","Chinese","Chinese","Cook Island","Dutch","Fijian","German","Indian","Italian","Japanese","Korean","American","NZ European","Maori","Polish","Samoan","Tongan"],placeholder:"please select (If the option does not exist, you can enter it manually)"})}),e(a.Item,{label:"Email",field:"Email",rules:[{required:!0,message:"required"}],children:e(v,{allowClear:!0,style:{width:"100%"},placeholder:"please enter"})}),e(a.Item,{label:"Learner Status",field:"Status",children:e(E,{allowClear:!0,options:["Achieved","Withdraws","Did Not Complete","Other"],placeholder:"please enter"})}),e(a.Item,{style:{textAlign:"center"},children:h(w,{children:[e(u,{loading:C,type:"primary",htmlType:"submit",children:"Submit"}),e(u,{onClick:i,children:"Reset"})]})})]})}const{Row:Ve,Col:Xe}=ie,Be=({rowData:m,ok:C})=>{const[c]=a.useForm(),[i,S]=s.exports.useState(!1),[b,x]=s.exports.useState(null),[o,y]=s.exports.useState(!1),I=oe(f=>f.userInfo),A=f=>{x(f)},N=f=>{S(f)},p=f=>{y(!0),f.type===1?k.sendEmail({EnrollmentID:m.EnrollmentID,email:i?I.mail:f.email}).then(F=>{F.data&&(g.success("Successfully sent!"),C())}).finally(()=>{y(!1)}):f.type===2&&k.sendEmailMicro({EnrollmentID:m.EnrollmentID,email:i?I.mail:f.email,NSN:f.NSN}).then(F=>{F.data&&(g.success("Successfully sent!"),C())}).finally(()=>{y(!1)})},L=()=>{c.resetFields(),S(!1),x(null)};return e(B,{children:h(ve,{tip:"Just a moment...",loading:o,children:[h("p",{children:["Learner Name:",`${m.FirstName||""} ${m.LastName||""}`]}),e(a,{form:c,className:G["search-form"],layout:"vertical",labelAlign:"left",wrapperCol:{span:24},style:{display:"inline-block",marginBottom:"10px"},onSubmit:p,children:h(Ve,{children:[e(a.Item,{label:"Choose Certificate",field:"type",rules:[{required:!0,message:"required"}],children:e(E,{showSearch:!0,options:[{label:"Certificate of Achievement",value:1},{label:"Micro-Credential",value:2}],placeholder:"Please enter",onChange:A})}),e(a.Item,{children:e(Le,{checked:i,onChange:N,children:"Send to default email"})}),!i&&e(a.Item,{label:"Send to Email",field:"email",rules:[{required:!0,message:"required"},{match:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"Please enter a valid email!"}],children:e(v,{placeholder:"Please enter email address"})}),b===2&&e(a.Item,{label:"NSN",field:"NSN",rules:[{required:!0,message:"required"}],children:e(v,{placeholder:"Please enter NSN"})}),e(a.Item,{style:{textAlign:"center"},children:h(w,{children:[e(u,{type:"primary",loading:o,onClick:()=>{c.submit()},children:"Submit"}),e(u,{onClick:L,children:"Reset"})]})})]})})]})})},ne=["Achieved","Merit","Excellence","Not Yet Achieved"];function et(){var H,Q;const m=[{title:"Learner Name",key:"StudentName",dataIndex:"StudentName",width:180,render:(t,l)=>`${l.FirstName||""} ${l.LastName||""}`},{title:"DOB",dataIndex:"DateOfBirth",key:"DateOfBirth",width:120,ellipsis:!0,render:t=>ze(t).format("YYYY-MM-DD")},{title:"Gender",dataIndex:"Gender",key:"Gender",width:85},{title:"Ethnicity",dataIndex:"Ethnicity",key:"Ethnicity",ellipsis:!0,width:150},{title:"Email",dataIndex:"Email",key:"Email",ellipsis:!0,width:120},{title:"School",dataIndex:"School",key:"School",ellipsis:!0,width:180},{title:"Learner Status",dataIndex:"Status",key:"Status",width:90,ellipsis:!0,render:t=>e("span",{style:{fontSize:"12px"},children:t})},{title:"Operation",dataIndex:"operation",key:"operation",width:150,render:(t,l)=>h(w,{children:[e(u,{type:"primary",size:"mini",onClick:r=>{r.stopPropagation(),L(l),q.setFieldsValue({...l,SchoolName:l.SchoolNumber?l.SchoolNumber:l.SchoolName}),T(!0)},children:"Edit"}),e("div",{onClick:r=>{r.stopPropagation()},children:e(le,{focusLock:!0,title:"Confirm",content:"Are you sure you want to delete?",onOk:()=>{be(l.EnrollmentID)},children:e(u,{type:"primary",status:"danger",size:"mini",children:"Delete"})})})]})}],[C,c]=s.exports.useState(!1),[i,S]=s.exports.useState([]),b=oe(t=>t.token),[x,o]=s.exports.useState({}),[y,I]=s.exports.useState({total:0,pageSize:10,current:1}),[A,N]=s.exports.useState(!1),[p,L]=s.exports.useState({}),[f,F]=s.exports.useState([]),[Y,ce]=s.exports.useState({}),[q]=ee(),[de,T]=s.exports.useState(!1),[he,J]=s.exports.useState(!1),[_]=ee(),[n,W]=s.exports.useState({}),[$,M]=s.exports.useState(!1),[me,Z]=s.exports.useState(!1),[pe,U]=s.exports.useState(!1),[V,j]=s.exports.useState(!1);s.exports.useEffect(()=>{b&&R()},[b]),s.exports.useEffect(()=>{(!V||$)&&W({})},[V,$]);const fe=t=>{ae.setStudentCourse(t).then(l=>{g.success(l==null?void 0:l.data),R()})},R=(t={})=>{c(!0),ae.getMyStudent({...y,...x,...t,total:void 0}).then(l=>{S((l==null?void 0:l.data)||[]),I({...y,...l==null?void 0:l.pagination})}).finally(()=>{c(!1)})},K=t=>{k.getCourseUnits({CourseID:t}).then(l=>{l.data&&W(l.data)})},Ce=t=>{const{current:l,pageSize:r}=t;I({...t,current:l,pageSize:r}),R({current:l,pageSize:r})};function Se(t){I({...y,current:1}),o(t),R({current:1,...t})}const be=t=>{k.deleteStudentInfo({EnrollmentID:t}).then(l=>{l!=null&&l.data&&(g.success("success"),R())})},ye=t=>{J(!0),k.postStudentInfo({EnrollmentID:p.EnrollmentID,...t}).then(l=>{l!=null&&l.data&&(T(!1),g.success("success"),q.resetFields(),R())}).finally(()=>{J(!1)})},ge=t=>{Z(!0),k.submitStudentResult({EnrollmentID:p.EnrollmentID,Result:t}).then(l=>{l!=null&&l.data&&(M(!1),g.success("success"),_.resetFields(),R())}).finally(()=>{Z(!1)})},Ie=t=>{var O,z,P;if(!t.Result)return"Not yet assessed";if(!(n!=null&&n.units)||!((O=n==null?void 0:n.course)!=null&&O.CourseName))return"Loading";const l=JSON.parse(t.Result),r=(z=n==null?void 0:n.units)==null?void 0:z.map(X=>({label:`${X.USName}:`,value:l[String(X.UnitStandardID)]})),d=[{label:`${(P=n==null?void 0:n.course)==null?void 0:P.CourseName} Full Course:`,value:l.Course},...r];return e(te,{layout:"inline-horizontal",column:1,border:!0,data:d})};return h(Oe,{children:[e(Te,{onSearch:Se}),e(Fe,{columns:m,rowKey:"EnrollmentID",expandedRowRender:t=>{const l=[{label:"Current Course:",value:t.CourseName},{label:"PhoneNumber:",value:t.PhoneNumber},{label:"WorkbookOption:",value:t.WorkbookOption},{label:"Address:",value:!t.StreetAddress&&!t.StreetAddress&&!t.StreetAddress?"-":`${t.StreetAddress||""}, ${t.City||""}, ${t.Region||""}`},{label:"Zipcode:",value:t.Zipcode},{label:"TeacherName:",value:t.TeacherName},{label:"TeacherEmail:",value:t.TeacherEmail},{label:"InvoiceEmail:",value:t.InvoiceEmail},{label:"AdditionalInfo:",value:t.AdditionalInfo}];return h(B,{children:[e(te,{layout:"inline-horizontal",border:!0,column:{xs:1,sm:2,md:2,lg:2,xl:3,xxl:4},data:l}),h(w,{children:[e(u,{type:"primary",size:"mini",onClick:r=>{r.stopPropagation(),L(t),N(!0)},children:"Courses filled in on the forms"}),e("div",{onClick:r=>{r.stopPropagation()},children:e(le,{focusLock:!0,icon:null,title:h("div",{style:{width:"300px"},children:[e("p",{children:" Assign Course"}),e(E,{allowCreate:!0,labelInValue:!0,showSearch:!0,allowClear:!0,options:f.map(r=>({label:r.CourseName,value:r.CourseID})),filterOption:(r,d)=>{var O,z,P;return((z=(O=d.props.value)==null?void 0:O.label)==null?void 0:z.toLowerCase().indexOf(r.toLowerCase()))>=0||((P=d.props)==null?void 0:P.children.toLowerCase().indexOf(r.toLowerCase()))>=0},placeholder:"please enter",onVisibleChange:r=>{r&&k.getCourse({}).then(d=>{F((d==null?void 0:d.data)||[])})},onChange:r=>{ce(r)}})]}),okText:"ok",cancelText:"cancel",onOk:()=>{fe({id:t.EnrollmentID,CourseName:Y.label,CourseID:Y.value})},children:e(u,{type:"primary",size:"mini",children:"Assign Course"})})}),e(u,{type:"primary",size:"mini",onClick:r=>{if(r.stopPropagation(),!t.CourseID)return g.warning("Please assign a course first");K(t.CourseID),L(t),M(!0)},children:"Assess"}),e(u,{type:"primary",size:"mini",onClick:r=>{if(r.stopPropagation(),!t.Result)return g.warning("Not yet assessed");JSON.parse(t.Result),L(t),K(t.CourseID),j(!0)},children:"Result"}),e(u,{type:"primary",size:"mini",onClick:r=>{if(r.stopPropagation(),t.Status==="Did Not Complete"||t.Status==="Withdraws")return g.warning(t.Status);if(!t.Result)return g.warning("Not yet assessed");const d=JSON.parse(t.Result);if(!(d!=null&&d.Course)||(d==null?void 0:d.Course)==="Not Yet Achieved")return g.warning("Not yet assessed");L(t),U(!0)},children:"Certificate"})]})]})},expandProps:{icon:({expanded:t,record:l,...r})=>t?e("button",{...r,children:e(Re,{})}):e("button",{...r,children:e(Ae,{})}),expandRowByClick:!0},data:i,loading:C,scroll:{x:1e3},border:{wrapper:!0,cell:!0},pagination:{...y,size:"mini",bufferSize:3,sizeCanChange:!0,showTotal:!0,showJumper:!0,pageSizeChangeResetCurrent:!0},onChange:Ce}),e(D,{title:"Courses filled in on the forms",visible:A,footer:e("div",{style:{textAlign:"center"},children:e(u,{type:"primary",onClick:()=>N(!1),children:"ok"})}),onCancel:()=>N(!1),autoFocus:!1,focusLock:!0,unmountOnExit:!0,style:{width:"800px"},children:e(Me,{rowData:p})}),e(D,{title:"Edit Remote Learner",visible:de,footer:null,onCancel:()=>{T(!1),q.resetFields()},autoFocus:!1,focusLock:!0,unmountOnExit:!0,style:{width:"600px"},children:e(Ue,{form:q,handleSubmit:ye,loading:he})}),e(D,{title:"Generate Certificate",visible:pe,footer:null,onCancel:()=>{U(!1)},autoFocus:!1,focusLock:!0,unmountOnExit:!0,children:e(Be,{rowData:p,ok:()=>{U(!1)}})}),e(D,{title:"Result",visible:V,footer:null,onCancel:()=>{j(!1)},autoFocus:!1,focusLock:!0,unmountOnExit:!0,children:Ie(p)}),e(D,{title:"Assess",visible:$,footer:null,onCancel:()=>{M(!1),_.resetFields()},autoFocus:!1,focusLock:!0,unmountOnExit:!0,style:{width:"500px"},children:h(a,{form:_,layout:"vertical",labelAlign:"left",wrapperCol:{span:24},onSubmit:ge,children:[e(a.Item,{label:"Learner Name",children:e(v,{defaultValue:`${(p==null?void 0:p.FirstName)||""} ${(p==null?void 0:p.LastName)||""}`,style:{width:"100%"},disabled:!0,placeholder:"please enter"})}),e(a.Item,{label:`${(H=n==null?void 0:n.course)==null?void 0:H.CourseName} Full Course`,field:"Course",rules:[{required:!0,message:"required"}],children:e(E,{allowClear:!0,options:ne,placeholder:"please enter"})}),(Q=n==null?void 0:n.units)==null?void 0:Q.map(t=>e(a.Item,{label:t.USName,field:String(t.UnitStandardID),rules:[{required:!0,message:"required"}],children:e(E,{allowClear:!0,options:ne,placeholder:"please enter"})},t.UnitStandardID)),e(a.Item,{style:{textAlign:"center"},children:h(w,{children:[e(u,{loading:me,type:"primary",htmlType:"submit",children:"Submit"}),e(u,{onClick:()=>{_.resetFields()},children:"Reset"})]})})]})})]})}export{et as default};
