import{K as E,r as t,k as m,C as y,aH as g,j as r,U as d,b6 as k,O as L,l as R,M as s}from"./index.5c46b2c4.js";import{h as C}from"./moment.0f22a298.js";import{s as u,e as M}from"./excelExport.6ee9338a.js";import"./exceljs.min.d921c119.js";import"./FileSaver.min.67a5fa73.js";const{YearPicker:N}=L;function b(){const o=[{title:"Month",dataIndex:"Month",ellipsis:!0},{title:"Workshop Learner Enrolments",dataIndex:"WorkshopLearnerEnrollments",ellipsis:!0},{title:"Remote Learner Enrolments",dataIndex:"LearnerEnrollments",ellipsis:!0},{title:"Withdrawn/Did Not Complete",dataIndex:"TotalWithdrawsCount",ellipsis:!0}],n=E(e=>e.token),[x,l]=t.exports.useState(!1),[i,c]=t.exports.useState([]),[a,h]=t.exports.useState(String(C().year())),p=()=>{l(!0),R.getReport1({year:a}).then(e=>{c((e==null?void 0:e.data)||[])}).catch(e=>{console.error("Error loading report 1:",e),s.error("Failed to load learner enrolments report. Please try again."),c([])}).finally(()=>{l(!1)})},f=async()=>{try{await M(o,i,"LEARNER ENROLMENTS + MONTH + YEAR"),s.success("Excel file exported successfully!")}catch(e){console.error("Error exporting report:",e),s.error("Failed to export Excel file. Please try again.")}};return t.exports.useEffect(()=>{n&&p()},[n,a]),m(y,{className:u["reports-result"],children:[m(g,{children:[r(N,{value:a,style:{width:200,marginBottom:10},onChange:e=>{h(e)},size:"mini"}),r(d,{onClick:()=>p(),type:"primary",size:"mini",style:{marginLeft:20},children:"Refresh"}),r(d,{size:"mini",onClick:f,type:"primary",style:{marginLeft:20},children:"Export Excel"})]}),r(k,{columns:o,data:i,loading:x,border:{wrapper:!0,cell:!0},pagination:!1,rowClassName:e=>(e==null?void 0:e.Month)==="Total"?u["is-summary"]:""})]})}export{b as default};
