import{r as a,K as j,k as g,C as D,aH as L,j as o,U as x,b6 as Y,O as z,l as B,M as n}from"./index.6f379340.js";import{h}from"./moment.0f22a298.js";import{s as E,e as M}from"./excelExport.9c5e893f.js";import"./exceljs.min.5c247d31.js";import"./FileSaver.min.efd7c8d4.js";const{RangePicker:N}=z;function v(){const[i,l]=a.exports.useState([]),c=j(e=>e.token),[k,p]=a.exports.useState(!1),[m,d]=a.exports.useState([]),[t,S]=a.exports.useState([String(h().year()),String(h().year())]),f=()=>{p(!0),B.getReport2((t==null?void 0:t.length)>0?{startYear:t[0],endYear:t[1]}:{}).then(e=>{const{headers:u,data:C}=e,r=u.map(s=>({title:s,dataIndex:s,key:s,width:150,ellipsis:!0}));r!=null&&r.length&&(r[0].fixed="left"),l(r);const b=C.map((s,w)=>{let y={key:w};return u.forEach((O,P)=>{y[O]=s[P]}),y});d(b)}).catch(e=>{console.error("Error loading report 2:",e),n.error("Failed to load workshops by region report. Please try again."),l([]),d([])}).finally(()=>{p(!1)})},R=async()=>{try{await M(i,m,"WORKSHOPS BY REGION + YEAR"),n.success("Excel file exported successfully!")}catch(e){console.error("Error exporting report:",e),n.error("Failed to export Excel file. Please try again.")}};return a.exports.useEffect(()=>{c&&f()},[c,t]),g(D,{className:E["reports-result"],children:[g(L,{children:[o(N,{value:t,mode:"year",style:{width:200,marginBottom:10},onChange:e=>{S(e)},size:"mini"}),o(x,{onClick:()=>f(),type:"primary",size:"mini",style:{marginLeft:20},children:"Refresh"}),o(x,{size:"mini",onClick:R,type:"primary",style:{marginLeft:20},children:"Export Excel"})]}),o(Y,{columns:i,data:m,loading:k,border:{wrapper:!0,cell:!0},scroll:{y:1250},pagination:!1,rowClassName:e=>(e==null?void 0:e.Month)==="Total"?E["is-summary"]:""})]})}export{v as default};
