import{r as a,K as D,k as g,C as M,aH as N,j as o,U as x,b6 as O,O as P,l as z,M as n}from"./index.6f379340.js";import{h}from"./moment.0f22a298.js";import{s as E,e as B}from"./excelExport.9c5e893f.js";import"./exceljs.min.5c247d31.js";import"./FileSaver.min.efd7c8d4.js";const{RangePicker:T}=P;function v(){const[l,i]=a.exports.useState([]),c=D(e=>e.token),[k,p]=a.exports.useState(!1),[m,d]=a.exports.useState([]),[t,R]=a.exports.useState([String(h().year()),String(h().year())]),u=()=>{p(!0),z.getReport3((t==null?void 0:t.length)>0?{startYear:t[0],endYear:t[1]}:{}).then(e=>{const{headers:f,data:C}=e,r=f.map(s=>({title:s,dataIndex:s,key:s,width:150,ellipsis:!0}));r!=null&&r.length&&(r[0].fixed="left"),i(r);const L=C.map((s,b)=>{let y={key:b};return f.forEach((j,w)=>{y[j]=s[w]}),y});d(L)}).catch(e=>{console.error("Error loading report 3:",e),n.error("Failed to load school learner numbers report. Please try again."),i([]),d([])}).finally(()=>{p(!1)})},S=async()=>{try{await B(l,m,"SCHOOL + LEARNER NUMBERS + YEAR"),n.success("Excel file exported successfully!")}catch(e){console.error("Error exporting report:",e),n.error("Failed to export Excel file. Please try again.")}};return a.exports.useEffect(()=>{c&&u()},[c,t]),g(M,{className:E["reports-result"],children:[g(N,{children:[o(T,{value:t,mode:"year",style:{width:200,marginBottom:10},onChange:e=>{R(e)},size:"mini"}),o(x,{onClick:()=>u(),type:"primary",size:"mini",style:{marginLeft:20},children:"Refresh"}),o(x,{size:"mini",onClick:S,type:"primary",style:{marginLeft:20},children:"Export Excel"})]}),o(O,{columns:l,data:m,loading:k,border:{wrapper:!0,cell:!0},scroll:{y:1250},pagination:!1,rowClassName:e=>(e==null?void 0:e.Month)==="Total"?E["is-summary"]:""})]})}export{v as default};
