import{r as a,K as w,k as g,C as D,aH as M,j as o,U as x,b6 as N,O as P,l as z,M as n}from"./index.6f379340.js";import{h}from"./moment.0f22a298.js";import{s as E,e as B}from"./excelExport.9c5e893f.js";import"./exceljs.min.5c247d31.js";import"./FileSaver.min.efd7c8d4.js";const{RangePicker:O}=P;function H(){const[l,i]=a.exports.useState([]),c=w(e=>e.token),[k,p]=a.exports.useState(!1),[m,u]=a.exports.useState([]),[t,R]=a.exports.useState([String(h().year()),String(h().year())]),d=()=>{p(!0),z.getReport5((t==null?void 0:t.length)>0?{startYear:t[0],endYear:t[1]}:{}).then(e=>{const{headers:f,data:C}=e,r=f.map(s=>({title:s,dataIndex:s,key:s,width:150,ellipsis:!0}));r!=null&&r.length&&(r[0].fixed="left"),i(r);const b=C.map((s,L)=>{let y={key:L};return f.forEach((T,j)=>{y[T]=s[j]}),y});u(b)}).catch(e=>{console.error("Error loading report 5:",e),n.error("Failed to load tutor learner numbers report. Please try again."),i([]),u([])}).finally(()=>{p(!1)})},S=async()=>{try{await B(l,m,"TUTOR + LEARNER NUMBERS + YEAR"),n.success("Excel file exported successfully!")}catch(e){console.error("Error exporting report:",e),n.error("Failed to export Excel file. Please try again.")}};return a.exports.useEffect(()=>{c&&d()},[c,t]),g(D,{className:E["reports-result"],children:[g(M,{children:[o(O,{value:t,mode:"year",style:{width:200,marginBottom:10},onChange:e=>{R(e)},size:"mini"}),o(x,{onClick:()=>d(),type:"primary",size:"mini",style:{marginLeft:20},children:"Refresh"}),o(x,{size:"mini",onClick:S,type:"primary",style:{marginLeft:20},children:"Export Excel"})]}),o(N,{columns:l,data:m,loading:k,border:{wrapper:!0,cell:!0},scroll:{y:1250},pagination:!1,rowClassName:e=>(e==null?void 0:e.Month)==="Total"?E["is-summary"]:""})]})}export{H as default};
