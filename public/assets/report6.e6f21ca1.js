import{r as a,K as j,k as g,C as w,aH as D,j as o,U as x,b6 as M,O as P,l as Y,M as n}from"./index.bfa4e677.js";import{h}from"./moment.0f22a298.js";import{s as E,e as z}from"./excelExport.fffc6efd.js";import"./exceljs.min.044c08df.js";import"./FileSaver.min.75cbdb4e.js";const{RangePicker:B}=P;function U(){const[i,l]=a.exports.useState([]),c=j(e=>e.token),[k,p]=a.exports.useState(!1),[m,d]=a.exports.useState([]),[t,R]=a.exports.useState([String(h().year()),String(h().year())]),u=()=>{p(!0),Y.getReport6((t==null?void 0:t.length)>0?{startYear:t[0],endYear:t[1]}:{}).then(e=>{const{headers:f,data:C}=e,r=f.map(s=>({title:s,dataIndex:s,key:s,width:150,ellipsis:!0}));r!=null&&r.length&&(r[0].fixed="left"),l(r);const b=C.map((s,L)=>{let y={key:L};return f.forEach((N,T)=>{y[N]=s[T]}),y});d(b)}).catch(e=>{console.error("Error loading report 6:",e),n.error("Failed to load ethnicity learner numbers report. Please try again."),l([]),d([])}).finally(()=>{p(!1)})},S=async()=>{try{await z(i,m,"ETHNICITY + LEARNER NUMBERS + YEAR"),n.success("Excel file exported successfully!")}catch(e){console.error("Error exporting report:",e),n.error("Failed to export Excel file. Please try again.")}};return a.exports.useEffect(()=>{c&&u()},[c,t]),g(w,{className:E["reports-result"],children:[g(D,{children:[o(B,{value:t,mode:"year",style:{width:200,marginBottom:10},onChange:e=>{R(e)},size:"mini"}),o(x,{onClick:()=>u(),type:"primary",size:"mini",style:{marginLeft:20},children:"Refresh"}),o(x,{size:"mini",onClick:S,type:"primary",style:{marginLeft:20},children:"Export Excel"})]}),o(M,{columns:i,data:m,loading:k,border:{wrapper:!0,cell:!0},scroll:{y:1250},pagination:!1,rowClassName:e=>(e==null?void 0:e.Month)==="Total"?E["is-summary"]:""})]})}export{U as default};
